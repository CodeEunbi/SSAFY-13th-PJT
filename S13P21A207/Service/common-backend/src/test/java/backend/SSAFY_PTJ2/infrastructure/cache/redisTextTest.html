<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>í…ìŠ¤íŠ¸ í•„í„° ì„¤ì • í…ŒìŠ¤íŠ¸</title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
    <h1>í…ìŠ¤íŠ¸ í•„í„° ì„¤ì • í…ŒìŠ¤íŠ¸</h1>
    
    <div>
        <h3>ì—°ê²° ìƒíƒœ: <span id="status">ì—°ê²° ì•ˆë¨</span></h3>
        <button onclick="connect()">ì—°ê²°</button>
        <button onclick="disconnect()">ì—°ê²° í•´ì œ</button>
    </div>
    
    <div>
        <h3>í•„í„° ì„ íƒ</h3>
        <label><input type="checkbox" value="IN"> IN (ìš•ì„¤)</label><br>
        <label><input type="checkbox" value="VI"> VI (í­ë ¥)</label><br>
        <label><input type="checkbox" value="SE"> SE (ì„±ì )</label><br>
        <label><input type="checkbox" value="AD"> AD (ê´‘ê³ )</label><br>
        <label><input type="checkbox" value="PO"> PO (ì •ì¹˜)</label><br>
        <button onclick="sendFilterSettings()">í•„í„° ì„¤ì • ì „ì†¡</button>
    </div>
    
    <div>
        <h3>ë¡œê·¸</h3>
        <pre id="log" style="border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: scroll;"></pre>
    </div>

    <script>
        let socket = null;

        function log(message) {
            const logEl = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logEl.textContent += `[${timestamp}] ${message}\n`;
            logEl.scrollTop = logEl.scrollHeight;
        }

        function connect() {
            socket = io('http://localhost:9092');
            
            socket.on('connect', () => {
                document.getElementById('status').textContent = 'âœ… ì—°ê²°ë¨';
                log('âœ… Socket.IO ì—°ê²° ì„±ê³µ: ' + socket.id);
            });
            
            socket.on('disconnect', () => {
                document.getElementById('status').textContent = 'âŒ ì—°ê²° ì•ˆë¨';
                log('âŒ ì—°ê²° ì¢…ë£Œ');
            });
            
            socket.on('error', (error) => {
                log('âŒ ì—ëŸ¬: ' + JSON.stringify(error));
            });
            
            socket.on('text-filter-settings-saved', (response) => {
                log('âœ… í…ìŠ¤íŠ¸ í•„í„° ì €ì¥ ì™„ë£Œ: ' + JSON.stringify(response));
            });
        }

        function disconnect() {
            if (socket) {
                socket.disconnect();
                socket = null;
            }
        }

        function sendFilterSettings() {
            if (!socket || !socket.connected) {
                alert('Socket.IOê°€ ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!');
                return;
            }
            
            const checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
            const enabledFilters = Array.from(checkboxes).map(cb => cb.value);
            
            const data = { enabledFilters };
            
            log('ğŸ“¤ ì „ì†¡: ' + JSON.stringify(data));
            socket.emit('text-filter-settings', data);
        }
    </script>
</body>
</html>